# Bench

## 测试系统

1. Starry（S）：使用线程抽象
2. Starry + Coroutine（SC）：使用协程抽象
3. Starry + Coroutine + Controller（SCC）：使用协程抽象 + 控制器

## 测试指标

### 任务切换开销

> 1. 调度器开销
> 2. 上下文保存、恢复开销
> 3. 栈申请、回收开销
>
> Micro-Bench：使用 yield 接口，来统计总体开销，使用 fifo 调度器，关闭中断，使用 yield 接口和不使用 yield 接口来统计开销，使用 cycle 作为指标
> SC 情况下，需要统计栈切换的开销
> SCC 情况下，分别于 S、SC 进行对比
> 
> 还需要统计 await 与同步 yield 接口进行让权时的开销
>
> 还需要统计 S 与 SC 的中断抢占机制的开销，区别体现在返回时，S 需要先线程切换回到被打断的线程中，再执行 trap_return 回到正常执行流；SC 则会直接回到被打断的正常执行流

### 内存使用开销

> 统计整体的内存使用情况，使用协程抽象时，内存开销是动态变化的，随着时钟中断以及同步接口的使用情况变化